# プロジェクトのコーディング規約と開発ガイドライン

## 技術スタック (Tech Stack)

### 主要技術
- TypeScript 4.5.4
- Figma Plugin API (@figma/plugin-typings 1.110.0)
- Lodash 4.17.21
- Biome 1.9.4 (リンター・フォーマッター)

### ビルドツール
- esbuild 0.25.3
- rimraf 6.0.1

### 開発ツール
- Husky 9.1.7 (Git フック)
- lint-staged 15.5.1 (コミット前のリンティング)

## プロジェクト概要

Figmaのレイヤー名をデフォルト値にリセットするためのプラグインです。様々な要素（テキスト、フレーム、グループ、長方形、インスタンスなど）の名前をリセットすることができます。

要素の種類によって異なる挙動をします：
- コンポーネントやバリアントは名前を変更せず、オリジナルの名前を保持します
- インスタンスはメインコンポーネントの名前に変更されます
- インスタンスの子要素はメインコンポーネントの同じ子要素の名前に変更されます
- その他の要素は空の名前（リセット状態）に変更されます

## コーディング規約 (Coding Conventions)

### 全般的な規約
- TypeScript:
  - 厳格な型付けを使用し、`any`型の使用を避ける
  - 共通の型定義は `src/@types` ディレクトリで管理
- コードの構造:
  - 関連する機能は独自のモジュールにまとめる
  - 一つの関数は一つの責任を持つように設計
- エラー処理:
  - 明示的にエラーをハンドリングし、ユーザーにわかりやすいメッセージを表示
  - 早期リターンパターンを使用して条件分岐をフラット化
- パフォーマンス:
  - Figma APIの呼び出しを最小限に抑える
  - 非同期処理は適切に `async/await` を使用

### 命名規則
- 関数:
  - camelCase
  - アクション（動詞）で始める (例: `resetInstance`, `getOverrideValues`)
  - boolean値を返す関数: `is`/`has` プレフィックス
- 変数:
  - camelCase
  - 配列は複数形の名詞（例：`errors`, `overrideValues`）
  - boolean値は `is`/`has` プレフィックス
- ファイル名:
  - 機能ごとにファイルを分割
  - モジュールは index.ts を使用して集約
- インポート:
  - 相対パスではなく `@/` エイリアスを使用 (@: `${workspaceFolder}/src`)

### Figma API の使用
- API の型定義を適切に活用する
- ノードの型チェックを常に行う
- フォントの読み込みは非同期で適切に処理する
- オーバーライドの処理は慎重に行う

## フォーマット規則 (Formatting Rules)

- インデント: スペース 2 つ
- 引用符: シングルクォート (`'`)
- セミコロン: 使用
- 末尾カンマ: 配列・オブジェクトでは使用
- コメント: 複雑なロジックには説明コメントを追加

## エラー処理とデバッグ

- エラー処理:
  - 共通の `handleError` 関数を使用してエラーを一貫して処理
  - 結果は `Result` 型で返し、成功/失敗を明示的に表現
- デバッグ:
  - 開発時には `console.log` を使用して状態を確認
  - 本番ビルドでは esbuild の `--drop:console` オプションを使って除去
- 非同期処理:
  - Promise より `async/await` を優先
  - エラーは適切に `try/catch` または Result 型で処理

## プロジェクト構造

- `/src` - ソースコード
  - `/@types` - グローバル型定義
  - `/resetInstance` - インスタンスリセット関連の実装
  - `code.ts` - プラグインのエントリーポイント
  - `util.ts` - ユーティリティ関数

## テスト戦略

- 手動テスト:
  - 各種エレメントタイプに対するリセット機能を確認
  - エッジケース（選択なし、複数選択など）を確認
  - ユーザーへのフィードバック（通知）を確認

## コードレビュー基準 (Code Review Criteria)

- 型安全性が確保されているか
- Figma APIの使用が適切か
- エラー処理が適切に行われているか
- パフォーマンスの問題がないか
- 機能が仕様通りに動作するか
- コードの可読性が高いか
